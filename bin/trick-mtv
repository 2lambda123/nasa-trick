#!/usr/bin/perl

# trick_dp that determines trick_home based on execution location of this script.

use File::Basename ;
use Cwd 'abs_path';

if ( ! exists $ENV{TRICK_HOME} ) {
    $trick_bin = dirname(abs_path($0)) ;
    $trick_home = dirname($trick_bin) ;

    # set TRICK_HOME based on the value of trick_home
    $ENV{TRICK_HOME} = $trick_home ;
}

if ( $^O eq "darwin" ) {
    $command = "java -classpath $ENV{TRICK_HOME}/libexec/trick/java/dist/*:$ENV{TRICK_HOME}/libexec/trick/java/lib/* \\
         -Xdock:name=\"Event/Malfunction Trick View\" \\
         -Xdock:icon=$ENV{TRICK_HOME}/libexec/trick/java/resources/trick_icon.png \\
         trick.mtv.MtvApp " . join (" " , @ARGV) ;
} else {
    $command = "java -cp $ENV{TRICK_HOME}/libexec/trick/java/dist/*:$ENV{TRICK_HOME}/libexec/trick/java/lib/* trick.mtv.MtvApp " . join (" " , @ARGV) ;
}
print "$command\n" ;
system $command ;
exit $? >> 8;

